# API ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙƒÙˆØ¨ÙˆÙ† - Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ù…Ù†ÙŠ

## Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©
ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ API Ø¬Ø¯ÙŠØ¯ Ù„Ø¬Ù„Ø¨ ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙƒÙˆØ¨ÙˆÙ† Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø¹Ø§Ø¯ÙŠÙŠÙ† Ù…Ø¹ Ù…Ø±Ø§Ø¹Ø§Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø¹ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø£Ù…Ù†ÙŠØ©.

## Ø§Ù„Ù€ API Ø§Ù„Ø¬Ø¯ÙŠØ¯

### Endpoint:
```
GET /coupon/details/:couponCode
```

### Ø§Ù„Ù…Ø«Ø§Ù„:
```bash
GET /coupon/details/SAVE20
```

## Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ù…Ù†ÙŠ

### âœ… Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¢Ù…Ù†Ø© Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø©:

1. **Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø£Ø³Ø§Ø³ÙŠØ©:**
   - `code`: ÙƒÙˆØ¯ Ø§Ù„ÙƒÙˆØ¨ÙˆÙ† (Ù…Ø¹Ù„ÙˆÙ… Ù…Ø³Ø¨Ù‚Ø§Ù‹ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…)
   - `name`: Ø§Ø³Ù… Ø§Ù„ÙƒÙˆØ¨ÙˆÙ† (Ù„Ù„Ø¹Ø±Ø¶)
   - `type`: Ù†ÙˆØ¹ Ø§Ù„Ø®ØµÙ… (percentage/fixed)
   - `value`: Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®ØµÙ…

2. **Ø´Ø±ÙˆØ· Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:**
   - `minOrderAmount`: Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„Ø·Ù„Ø¨
   - `maxDiscount`: Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„Ø®ØµÙ…
   - `validFrom`: ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
   - `validTo`: ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡

3. **Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø­Ø§Ù„Ø©:**
   - `isActive`: Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ù…Ø­Ø³ÙˆØ¨Ø©
   - `isUnlimited`: Ù‡Ù„ Ø§Ù„ÙƒÙˆØ¨ÙˆÙ† ØºÙŠØ± Ù…Ø­Ø¯ÙˆØ¯
   - `status.isValid`: ØµØ§Ù„Ø­ Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£Ù… Ù„Ø§
   - `status.reason`: Ø³Ø¨Ø¨ Ø¹Ø¯Ù… Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©

### ðŸ”’ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø³Ø© Ø§Ù„Ù…Ø®ÙÙŠØ©:

1. **`usedCount`**: Ø¹Ø¯Ø¯ Ù…Ø±Ø§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
   - **Ù„Ù…Ø§Ø°Ø§ Ù…Ø®ÙÙŠ:** ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ Ù„Ù…Ø¹Ø±ÙØ© Ø´Ø¹Ø¨ÙŠØ© Ø§Ù„ÙƒÙˆØ¨ÙˆÙ† Ø£Ùˆ Ø§Ù„ØªÙ„Ø§Ø¹Ø¨
   - **Ø§Ù„Ø¨Ø¯ÙŠÙ„:** `isUnlimited` ÙŠÙˆØ¶Ø­ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø­Ø¯ÙˆØ¯ Ø£Ù… Ù„Ø§

2. **`usageLimit`**: Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
   - **Ù„Ù…Ø§Ø°Ø§ Ù…Ø®ÙÙŠ:** Ù…Ø¹Ù„ÙˆÙ…Ø© ØªØ¬Ø§Ø±ÙŠØ© Ø­Ø³Ø§Ø³Ø©
   - **Ø§Ù„Ø¨Ø¯ÙŠÙ„:** `status.isValid` ÙŠÙˆØ¶Ø­ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ØªØ§Ø­ Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…

3. **`createdBy`**: Ù…Ù†Ø´Ø¦ Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†
   - **Ù„Ù…Ø§Ø°Ø§ Ù…Ø®ÙÙŠ:** Ù…Ø¹Ù„ÙˆÙ…Ø© Ø¥Ø¯Ø§Ø±ÙŠØ© Ø¯Ø§Ø®Ù„ÙŠØ©
   - **Ø§Ù„Ø£Ù…Ø§Ù†:** Ù„Ø§ ÙŠØ¬Ø¨ ÙƒØ´Ù Ù‡ÙˆÙŠØ© Ø§Ù„Ù…Ø¯ÙŠØ±ÙŠÙ†

4. **`_id`**: Ù…Ø¹Ø±Ù Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
   - **Ù„Ù…Ø§Ø°Ø§ Ù…Ø®ÙÙŠ:** ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ ÙÙŠ Ù‡Ø¬Ù…Ø§Øª enumeration
   - **Ø§Ù„Ø¨Ø¯ÙŠÙ„:** Ø§Ø³ØªØ®Ø¯Ø§Ù… `couponCode` ÙƒÙ…Ø¹Ø±Ù

## Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø£Ù…Ù†ÙŠØ© Ø§Ù„Ù…Ø·Ø¨Ù‚Ø©

### 1. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù†Ø´Ø§Ø·
```typescript
const coupon = await this.couponRepository.findOne({
    code: couponCode.toUpperCase(),
    isActive: true  // ÙÙ‚Ø· Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø©
});
```

### 2. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„ØªØ§Ø±ÙŠØ®
```typescript
const now = new Date();
const validFrom = new Date(coupon.validFrom);
const validTo = new Date(coupon.validTo);
const isDateValid = now >= validFrom && now <= validTo;
```

### 3. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø¯ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
```typescript
const isUsageLimitValid = coupon.usageLimit === -1 || coupon.usedCount < coupon.usageLimit;
```

### 4. Ø­Ø³Ø§Ø¨ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©
```typescript
const safeDetails = {
    // ... Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¢Ù…Ù†Ø©
    isActive: coupon.isActive && isDateValid && isUsageLimitValid,
    status: {
        isValid: isDateValid && isUsageLimitValid && coupon.isActive,
        reason: // Ø³Ø¨Ø¨ ÙˆØ§Ø¶Ø­ Ù„Ø¹Ø¯Ù… Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©
    }
};
```

## Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¢Ù…Ù†Ø©

### 1. Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙƒÙˆØ¨ÙˆÙ† ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø£Ù…Ø§Ù…ÙŠØ©
```javascript
// Frontend ÙŠÙ…ÙƒÙ†Ù‡ Ø¹Ø±Ø¶:
// - Ù†ÙˆØ¹ ÙˆÙ‚ÙŠÙ…Ø© Ø§Ù„Ø®ØµÙ…
// - Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„Ø·Ù„Ø¨
// - ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡
// - Ø­Ø§Ù„Ø© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©
```

### 2. Ø§Ù„ØªØ­Ù‚Ù‚ Ù‚Ø¨Ù„ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†
```javascript
// Ù‚Ø¨Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ØŒ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù†:
// - Ù‡Ù„ Ø§Ù„ÙƒÙˆØ¨ÙˆÙ† ØµØ§Ù„Ø­ØŸ
// - Ù‡Ù„ Ø§Ù„Ù…Ø¨Ù„Øº ÙŠØ­Ù‚Ù‚ Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ØŸ
// - Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø®ØµÙ… Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ØŸ
```

### 3. Ø¹Ø±Ø¶ Ø±Ø³Ø§Ø¦Ù„ Ø®Ø·Ø£ ÙˆØ§Ø¶Ø­Ø©
```javascript
if (!response.data.status.isValid) {
    showError(response.data.status.reason);
}
```

## Ù…Ù‚Ø§Ø±Ù†Ø© Ù…Ø¹ Ø§Ù„Ù€ APIs Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©

### API Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠ (getCouponById)
```typescript
// ÙŠØªØ·Ù„Ø¨ ØµÙ„Ø§Ø­ÙŠØ§Øª Admin
@Roles([RoleTypes.ADMIN])
@UseGuards(AuthGuard, RolesGuard)
// ÙŠØ¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¨Ù…Ø§ ÙÙŠ Ø°Ù„Ùƒ Ø§Ù„Ø­Ø³Ø§Ø³Ø©
```

### API Ø§Ù„ØªØ­Ù‚Ù‚ (validateCoupon)
```typescript
// ÙŠØªØ·Ù„Ø¨ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ù„Ø¨
@Post("validate")
// ÙŠØ­Ø³Ø¨ Ø§Ù„Ø®ØµÙ… Ø§Ù„ÙØ¹Ù„ÙŠ
// Ù„Ø§ ÙŠØ¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†
```

### API Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯ (getCouponDetails)
```typescript
// Ù„Ø§ ÙŠØªØ·Ù„Ø¨ Ù…ØµØ§Ø¯Ù‚Ø©
@Get("details/:couponCode")
// ÙŠØ¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¢Ù…Ù†Ø© ÙÙ‚Ø·
// Ù…ÙÙŠØ¯ Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ù‚Ø¨Ù„ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
```

## Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ÙŠØ©

### ÙƒÙˆØ¨ÙˆÙ† ØµØ§Ù„Ø­:
```json
{
  "success": true,
  "data": {
    "code": "SAVE20",
    "name": "Ø®ØµÙ… 20%",
    "type": "percentage",
    "value": 20,
    "minOrderAmount": 100,
    "maxDiscount": 50,
    "validFrom": "2024-01-01T00:00:00.000Z",
    "validTo": "2024-12-31T23:59:59.000Z",
    "isActive": true,
    "isUnlimited": false,
    "status": {
      "isValid": true,
      "reason": "Valid"
    }
  }
}
```

### ÙƒÙˆØ¨ÙˆÙ† Ù…Ù†ØªÙ‡ÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©:
```json
{
  "success": true,
  "data": {
    "code": "EXPIRED10",
    "name": "Ø®ØµÙ… Ù…Ù†ØªÙ‡ÙŠ",
    "type": "percentage",
    "value": 10,
    "minOrderAmount": 50,
    "maxDiscount": 25,
    "validFrom": "2023-01-01T00:00:00.000Z",
    "validTo": "2023-12-31T23:59:59.000Z",
    "isActive": false,
    "isUnlimited": true,
    "status": {
      "isValid": false,
      "reason": "Coupon is expired or not yet valid"
    }
  }
}
```

### ÙƒÙˆØ¨ÙˆÙ† ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯:
```json
{
  "success": false,
  "message": "Coupon not found"
}
```

## Ø§Ù„ØªÙˆØµÙŠØ§Øª Ø§Ù„Ø£Ù…Ù†ÙŠØ©

### 1. Rate Limiting
```typescript
// ÙŠÙÙ†ØµØ­ Ø¨Ø¥Ø¶Ø§ÙØ© rate limiting Ù„Ù…Ù†Ø¹ Ø§Ù„Ù€ brute force
@Throttle(10, 60) // 10 requests per minute
```

### 2. Input Validation
```typescript
// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© couponCode
@Param('couponCode', new ValidationPipe({
  transform: true,
  whitelist: true
}))
```

### 3. Logging
```typescript
// ØªØ³Ø¬ÙŠÙ„ Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©
this.logger.log(`Coupon details requested: ${couponCode}`);
```

## Ø§Ù„Ø®Ù„Ø§ØµØ©

### âœ… Ø§Ù„Ù€ API Ø¢Ù…Ù† Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¹Ø§Ù… Ù„Ø£Ù†Ù‡:
1. **Ù„Ø§ ÙŠÙƒØ´Ù Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø­Ø³Ø§Ø³Ø©** (usedCount, usageLimit, createdBy)
2. **ÙŠØ¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù…ÙÙŠØ¯Ø© ÙÙ‚Ø·** Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ
3. **ÙŠØ·Ø¨Ù‚ Ø¬Ù…ÙŠØ¹ Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„ØªØ­Ù‚Ù‚** Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©
4. **ÙŠÙˆÙØ± Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙˆØ§Ø¶Ø­Ø©** Ø¹Ù† Ø­Ø§Ù„Ø© Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†
5. **Ù„Ø§ ÙŠØªØ·Ù„Ø¨ Ù…ØµØ§Ø¯Ù‚Ø©** Ù…Ù…Ø§ ÙŠØ¬Ø¹Ù„Ù‡ Ø³Ù‡Ù„ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…

### ðŸŽ¯ Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©:
- Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙƒÙˆØ¨ÙˆÙ† ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ù…Ù†ØªØ¬
- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„ÙƒÙˆØ¨ÙˆÙ† Ù‚Ø¨Ù„ Ø§Ù„Ø·Ù„Ø¨
- Ø¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø®ØµÙ… ÙÙŠ Ø³Ù„Ø© Ø§Ù„ØªØ³ÙˆÙ‚
- Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ø¦Ù„ Ø®Ø·Ø£ ÙˆØ§Ø¶Ø­Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…

Ø§Ù„Ù€ API Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙÙŠ Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø¨Ø£Ù…Ø§Ù† ØªØ§Ù….